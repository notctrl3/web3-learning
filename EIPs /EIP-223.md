## [EIP-223](https://eips.ethereum.org/EIPS/eip-223): Token with transaction handling model

### Motivation                            
 传统ERC-20痛点：
  - 代币转账给合约可能丢失。ERC-20 的`transfer(address to, uint256 value)`只是简单把余额加减，不会检查 to 是合约还是 EOA。
如果 to 是一个合约，而该合约没有特意写 tokenFallback 或类似逻辑，这笔代币就“卡在合约里”，用户可能永远找不回。
  - 缺少通知机制。ERC-20 收款方合约完全不知道自己收到了代币，无法自动触发逻辑。比如：想做 DeFi 时收到代币自动做某操作，ERC-20 做不到。
  - Gas 效率问题。有些现有做法（比如手动先 approve 再 transferFrom）需要多步交易，浪费 gas。
### Specification
  合约想要收到token必须实现`tokenReceived`,未实现`tokenReceived`的合约收到token会revert
#### Token 合约函数  
  | 函数                                                                 | 作用                                                                                                     |
| -------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| `name() → string`                                                    | 返回 token 名称                                                                                            |
| `symbol() → string`                                                  | 返回 token 符号（简称）                                                                                        |
| `decimals() → uint8`                                                 | 返回小数位数 (类似 ERC‑20)                                                                                     |
| `totalSupply() → uint256`                                            | 返回总发行量                                                                                                 |
| `balanceOf(address _owner) → uint256`                                | 查询某地址余额                                                                                                |
| `transfer(address _to, uint256 _value) → bool`                       | 向地址 `_to` 转账 `_value` token。<br>如果 `_to` 是普通地址 (EOA)，行为类似 ERC‑20；如果 `_to` 是合约，则尝试在接收合约上调用`tokenReceived`接口。 |
| `transfer(address _to, uint256 _value, bytes calldata _data) → bool` | 带附加数据 `data` 的`transfer`版本                                        |
| `function tokenReceived(address _from, uint _value, bytes calldata _data) returns (bytes4)`| 处理转账token的函数
#### 接收合约函数
``` solidity
function tokenReceived(
  address _from,         // 转账发起方
  uint _value,           // 接收的 token 数量
  bytes calldata _data   // 附加数据，可携带操作指令或信息
) returns (bytes4)
```
 - 当合约收到 token 时被调用。返回特定 magic value 表示成功处理。
 - 代币不会意外丢失，合约可以做自定义处理逻辑。
### Example
[ERC223-token-standard](https://github.com/Dexaran/ERC223-token-standard/blob/development/token/ERC223/ERC223.sol)
